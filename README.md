# RolmOCR 文字识别系统

基于Qwen2.5-VL大型视觉语言模型的OCR文字识别系统，能够高效准确地识别各类图片中的文字。

## 功能特点

- 强大的文字识别能力：基于Qwen2.5-VL大模型，能够识别各类复杂场景中的文字
- 支持批量处理：可以同时处理多张图片，提高工作效率
- 友好的图形界面：提供直观的Web界面，方便上传图片和查看结果
- 可定制参数：支持调整温度、采样方式等参数，满足不同场景需求
- 预处理优化：自动调整图片尺寸和增强对比度，提高识别效果

## 安装依赖

首先安装必要的依赖包：

```bash
pip install -r requirements.txt
```

主要依赖包括：
- transformers
- torch
- gradio
- pillow
- tqdm

## 快速开始

### 启动Web界面

```bash
python rolmocr_offline.py --host 127.0.0.1 --port 7860
```

可选参数：
- `--host`：服务器主机地址，默认为127.0.0.1
- `--port`：服务器端口，默认为12319
- `--share`：是否创建公共链接，便于分享给他人访问
- `--model`：模型路径或名称，默认为"Qwen/Qwen2.5-VL"
- `--debug`：启用调试模式，获取更多日志信息

### 命令行使用

也可以直接在命令行中处理单张图片：

```bash
python rolmocr_offline.py /path/to/image.jpg --output result.txt
```

批量处理多张图片：

```bash
python rolmocr_offline.py --batch image_list.txt --output results.txt
```

其中`image_list.txt`为包含图片路径的文本文件，每行一个图片路径。

## Web界面使用说明

1. 启动服务后，通过浏览器访问 http://127.0.0.1:7860（或设定的其他端口）
2. 点击"上传图片"按钮或直接拖拽图片到指定区域
3. 可选：在"高级设置"中调整识别参数
   - 提示词：可以调整提示词以获得不同的识别效果
   - 温度：控制生成文本的随机性，值越大结果越多样
   - Top P：控制采样的概率阈值
   - 最大生成Token数：控制生成文本的最大长度，对于文字较多的图片可以适当调高
4. 点击"开始识别"按钮
5. 识别结果会显示在右侧文本框中

## 实现原理

RolmOCR基于Qwen2.5-VL多模态大模型实现文字识别功能。它通过以下步骤处理图像：

1. 图像预处理：调整大小、转换颜色格式
2. 使用专为Qwen2.5-VL优化的处理方法处理图像
3. 通过大模型生成文字识别结果
4. 后处理文本结果并展示

## 注意事项

- 首次运行时会自动下载模型，需要良好的网络连接
- 推荐使用GPU加速，以获得更好的性能
- 图片过大时会自动调整大小，以符合模型处理要求
- 部分复杂场景或模糊图片可能识别效果不佳

## 示例

将图片放入`images`文件夹，然后运行：

```bash
python rolmocr_offline.py images/example.jpg
```

或者启动Web界面后通过浏览器上传图片并识别。 